# .github/workflows/main-ci-cd.yml (CORRIGIDO)
name: CI/CD - Frontend Applications

on:
  workflow_dispatch: {}
  push:
    branches:
      - develop
      - main

jobs:
  # Job para o ambiente de Desenvolvimento
  run-dev-workflow:
    if: github.ref == 'refs/heads/develop'
    name: ðŸš€ Deploy to Development
    uses: ./.github/workflows/reusable-build-deploy.yml
    with:
      environment-name: dev
    secrets:
      AWS_ROLE_TO_ASSUME: ${{ secrets.AWS_ROLE_TO_ASSUME_DEV }}

  # Job para o ambiente de ProduÃ§Ã£o
  run-prd-workflow:
    if: github.ref == 'refs/heads/main'
    name: ðŸš€ Deploy to Production
    # A linha "environment: production" foi REMOVIDA daqui.
    # A regra de aprovaÃ§Ã£o serÃ¡ acionada porque o workflow reutilizÃ¡vel
    # usa o input 'prd' para definir o ambiente internamente.
    uses: ./.github/workflows/reusable-build-deploy.yml
    with:
      environment-name: prd
    secrets:
      AWS_ROLE_TO_ASSUME: ${{ secrets.AWS_ROLE_TO_ASSUME_PRD }}
